/* Player Movement Animations */
/* Jump, flight arc, bounce, and lift animations */

/* Simple jump animation used for player avatar when moving */
@keyframes jump {
    0% {
        transform: translateY(0);
    }

    30% {
        transform: translateY(-12px);
    }

    100% {
        transform: translateY(0);
    }
}

.animate-jump {
    animation-name: jump;
    animation-duration: 600ms;
    animation-timing-function: cubic-bezier(.22, .9, .33, 1);
    animation-fill-mode: both;
}

/* Player overlay flight/bounce styling */
.player-overlay {
    position: absolute;
    will-change: transform, left, top;
    display: flex;
    align-items: center;
    justify-content: center;
    transition-property: transform, opacity;
    transition-timing-function: cubic-bezier(.22, .9, .33, 1);
    /* duration will be set inline via style="--fly-duration: 500ms" */
    transition-duration: var(--fly-duration, 500ms);
    pointer-events: none;
    z-index: 40;
}

.player-overlay.bounce {
    /* Very short bounce after landing to avoid pre-flight popping; keep subtle */
    animation: player-bounce 50ms cubic-bezier(.22, .9, .34, 1) 1;
}

/* Disable transition during active flight so animation is smooth */
.player-overlay.player-flying {
    animation-name: flight-arc;
    animation-duration: var(--fly-duration, 500ms);
    animation-timing-function: cubic-bezier(.22, .9, .33, 1);
    animation-fill-mode: both;
    transition: none;
}

@keyframes player-bounce {
    0% {
        transform: translateY(0);
    }

    40% {
        transform: translateY(-4px);
    }

    100% {
        transform: translateY(0);
    }
}

/* Flight arc for moving between tiles - UNIFIED lift + horizontal arc in single smooth motion */
/* Lift duration is ~150ms of the total animation, rest is horizontal flight */
/* Arc height adapts to movement direction: adds 20px arc regardless of vertical movement */
@keyframes flight-arc {
    0% {
        /* Start at ground level (0) */
        transform: translate(0, 0);
    }

    15% {
        /* ~0-63ms into animation: lift up to peak height (-20px above start) */
        transform: translate(0, -20px);
    }

    50% {
        /* ~210ms: at midpoint of both horizontal and vertical travel */
        /* Peak of arc: interpolate both dx and dy, add 20px upward boost */
        transform: translate(calc(var(--fly-dx, 0) * 0.5), calc(var(--fly-dy, 0) * 0.5 - 20px));
    }

    85% {
        /* ~357ms: near destination, starting descent */
        /* 85% of the way there horizontally and vertically */
        transform: translate(calc(var(--fly-dx, 0) * 0.85), calc(var(--fly-dy, 0) * 0.85 - 8px));
    }

    100% {
        /* Land at destination tile */
        transform: translate(var(--fly-dx, 0), var(--fly-dy, 0));
    }
}

/* Initial lift phase (vertical only) */
.player-lift {
    transform: translateY(var(--lift-y, -18px));
    transition: transform var(--lift-duration, 150ms) cubic-bezier(.22, .9, .33, 1);
}